
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Mavnn's blog</title>
  <meta name="author" content="mavnn">

  
  <meta name="description" content="Type providers, by their very nature, tend to access data external to the .net ecosystem. It can also be very awkward technically to make use of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <link rel="canonical" href="http://blog.mavnn.co.uk/index.html">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Mavnn's blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-37561687-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body   >
  <header role="banner"><hgroup>
  <a href="http://mavnn.co.uk"><img class="swirl-logo" src="/images/swirl.svg"/></a>
  <h1><a href="/">Mavnn's blog</a></h1>
  
    <h2>Stuff from my brain</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.mavnn.co.uk" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/emparsec-embedded-parser-library/">EmParsec Embedded Parser Library</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2016-01-18T12:53:11+00:00" pubdate data-updated="true">Jan 18<span>th</span>, 2016</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Type providers, by their very nature, tend to access data external to the .net ecosystem. It can also be very awkward technically to make use of dependencies during the actual type generation process.</p>

<p>This is rather a pity, because accessing all of that external data is much nicer and easier when you have a decent parser to do it with. And F# has very, very nice parser support via the <a href="http://www.quanttec.com/fparsec/">FParsec</a> library. Instead, many (most?) type providers end up creating mini-one shot parsers which can be a bit slow to write and don&rsquo;t tend to have features that come for free in a more complete solution such as nice error reporting.</p>

<p>Writing yet an other parser (YAOP) this week I decided that enough was enough. What I needed was a shared resource that people could pool improvements for that could be easily embedded in projects like type providers were it isn&rsquo;t desirable (or sometimes possible) to take external binary dependencies.</p>

<p>So I built it.</p>

<p>EmParsec is a single file parser combinator &ldquo;library&rdquo;, inspired by both FParsec library and <a href="http://fsharpforfunandprofit.com/posts/understanding-parser-combinators/">Scott&rsquo;s excellent series on building parser combinators</a>.</p>

<p>It consists of a single fsx file that can be loaded in the editor of your choice without any requirement for a project file or similar. When you want to use it, you can just reference it as a <a href="https://fsprojects.github.io/Paket/github-dependencies.html">Paket GitHub dependency</a> (which you&rsquo;ll be wanting to do for the ProvidedTypes.fs file if you&rsquo;re creating a type provider anyway) or even just copy the file across.</p>

<p>If you are compiling EmParsec into a larger project, it marks itself as &ldquo;internal&rdquo; so that you don&rsquo;t pollute the end users name space, and so that if two projects you reference have embedded different versions of EmParsec there are no collisions.</p>

<h2>How do I use it?</h2>

<p>So, you&rsquo;ve added EmParsec.fsx to your project (manually or with Paket) and now you&rsquo;re wondering how to use it. Let&rsquo;s build some simple examples.</p>

<h3>Matching an exact string</h3>

<p>Let&rsquo;s start with something simple: what if I just want to match a string?</p>

<p>Parser combinator libraries allow you to combine parsers from simpler parsers (hence the name), but in this case <code>pstring</code> (the &lsquo;p&rsquo; is there to avoid clashing with the existing <code>string</code> function) is provided for us by EmParsec.</p>

<p>Let&rsquo;s try it out!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">open</span> <span class="nc">EmParsec</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">thingParser</span> <span class="o">=</span> <span class="n">pstring</span> <span class="s2">&quot;thing&quot;</span>
</span><span class='line'><span class="c1">// When you enter this line, F# give a &quot;Value restriction&quot; error.</span>
</span><span class='line'><span class="c1">// You can either mark thingParser as type UParser&lt;string&gt;, or</span>
</span><span class='line'><span class="c1">// use the parser with run as below and the error will disappear.</span>
</span><span class='line'>
</span><span class='line'><span class="n">run</span> <span class="n">thingParser</span> <span class="s2">&quot;thing&quot;</span>
</span><span class='line'><span class="c1">// val it : Choice&lt;string,string&gt; = Choice1Of2 &quot;thing&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">run</span> <span class="n">thingParser</span> <span class="s2">&quot;th1ng&quot;</span>
</span><span class='line'><span class="c1">// val it : Choice&lt;string,string&gt; =</span>
</span><span class='line'><span class="c1">//   Choice2Of2</span>
</span><span class='line'><span class="c1">//     &quot;Parser &lt;string thing&gt; failed at line 0 column 2</span>
</span><span class='line'><span class="c1">// Unexpected [&#39;1&#39;]</span>
</span><span class='line'><span class="c1">// th1ng</span>
</span><span class='line'><span class="c1">//   ^&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Not bad! It even marks the unexpected character in the error output.</p>

<p>Unfortunately:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="n">run</span> <span class="n">thingParser</span> <span class="s2">&quot;thing and more&quot;</span>
</span><span class='line'><span class="c1">// val it : Choice&lt;string,string&gt; = Choice1Of2 &quot;thing&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>That probably isn&rsquo;t the behaviour you were hoping for. There&rsquo;s still input left after the parser has finished, but that isn&rsquo;t being seen as an error. EmParsec includes the <code>pend</code> parser for just this type of occasion &ndash; a parser that checks the input is exhausted.</p>

<p>So we want a parser that parses &ldquo;thing&rdquo; and then ends.</p>

<p>Let&rsquo;s go:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">let</span> <span class="n">thingParser2</span> <span class="o">=</span> <span class="n">andThen</span> <span class="o">(</span><span class="n">pstring</span> <span class="s2">&quot;thing&quot;</span><span class="o">)</span> <span class="n">pend</span>
</span><span class='line'><span class="c1">// normally written</span>
</span><span class='line'><span class="k">let</span> <span class="n">thingParser2&#39;</span> <span class="o">=</span> <span class="n">pstring</span> <span class="s2">&quot;thing&quot;</span> <span class="o">.&gt;&gt;.</span> <span class="n">pend</span>
</span><span class='line'>
</span><span class='line'><span class="n">run</span> <span class="n">thingParser2</span> <span class="s2">&quot;thing&quot;</span>
</span><span class='line'><span class="c1">// val it : Choice&lt;(string * unit),string&gt; = Choice1Of2 (&quot;thing&quot;, null)</span>
</span><span class='line'>
</span><span class='line'><span class="n">run</span> <span class="n">thingParser2</span> <span class="s2">&quot;th1ng&quot;</span>
</span><span class='line'><span class="c1">// val it : Choice&lt;(string * unit),string&gt; =</span>
</span><span class='line'><span class="c1">//   Choice2Of2</span>
</span><span class='line'><span class="c1">//     &quot;Parser (&lt;string thing&gt; andThen &lt;end&gt;) failed at line 0 column 2</span>
</span><span class='line'><span class="c1">// Unexpected [&#39;1&#39;]</span>
</span><span class='line'><span class="c1">// th1ng</span>
</span><span class='line'><span class="c1">//   ^&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">run</span> <span class="n">thingParser2</span> <span class="s2">&quot;thing and more&quot;</span>
</span><span class='line'><span class="c1">// val it : Choice&lt;(string * unit),string&gt; =</span>
</span><span class='line'><span class="c1">//   Choice2Of2</span>
</span><span class='line'><span class="c1">//     &quot;Parser (&lt;string thing&gt; andThen &lt;end&gt;) failed at line 0 column 5</span>
</span><span class='line'><span class="c1">// Unexpected input remaining &#39; and more&#39;</span>
</span><span class='line'><span class="c1">// thing and more</span>
</span><span class='line'><span class="c1">//      ^&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s more like it. The only issue now is that we&rsquo;ve combined two parser, so we&rsquo;re getting back a tuple of two results.</p>

<p>A simple tweak tells EmParsec to throw away the unit result returned by <code>pend</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">let</span> <span class="n">improvedThingParser</span> <span class="o">=</span> <span class="n">pstring</span> <span class="s2">&quot;thing&quot;</span> <span class="o">.&gt;&gt;</span> <span class="n">pend</span>
</span><span class='line'>
</span><span class='line'><span class="n">run</span> <span class="n">improvedThingParser</span> <span class="s2">&quot;thing&quot;</span>
</span><span class='line'><span class="c1">// val it : Choice&lt;string,string&gt; = Choice1Of2 &quot;thing&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>&ldquo;Impressive,&rdquo; I hear you say: &ldquo;You can parse static strings!&rdquo;</p>

<h3>Parsing a simple template language</h3>

<p>You have a point. Let&rsquo;s tackle a simple template language. You know the kind of thing:</p>

<p><code>Welcome {name}! Please spend money here.</code></p>

<p>That kind of thing. I&rsquo;m going to start building up a set of helper parsers for this, applying some type annotations both to make the example code clearer and to avoid the value restriction errors that crop up until you actually use the parsers (those occur because these parsers can carry generic user state, but we&rsquo;re not going to go into using that here).</p>

<p>We have two &ldquo;types&rdquo; of token that can exist in our template language: values to be replaced, and text to be preserved. Let&rsquo;s start by creating a union type to contain our parse results:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">type</span> <span class="nc">TemplatePart</span> <span class="o">=</span>
</span><span class='line'>  <span class="o">|</span> <span class="nc">Text</span> <span class="k">of</span> <span class="kt">string</span>
</span><span class='line'>  <span class="o">|</span> <span class="nc">Value</span> <span class="k">of</span> <span class="kt">string</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then, we&rsquo;ll have a parser that will parse individual characters which are <em>not</em> an opening bracket:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">let</span> <span class="n">notOpenBracket</span> <span class="o">:</span> <span class="nc">UParser</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span> <span class="o">=</span>
</span><span class='line'>  <span class="n">satisfy</span> <span class="o">(</span><span class="k">fun</span> <span class="n">c</span> <span class="o">-&gt;</span> <span class="n">c</span> <span class="o">&lt;&gt;</span> <span class="kt">char</span> <span class="sc">&#39;{&#39;</span><span class="o">)</span> <span class="s2">&quot;not open bracket&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>satisfy</code> is a function built into EmParsec which takes a predicate for whether or not it will consume the next character in the input stream. The final string argument is a name for the parser, which will be used in error messages.</p>

<p>Then we&rsquo;ll use that parser to create one that consumes as many &ldquo;not open bracket&rdquo; characters as it can, combines them into a string and then counts that string as a <code>Text</code> part.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">let</span> <span class="n">textParser</span> <span class="o">:</span> <span class="nc">UParser</span><span class="o">&lt;</span><span class="nc">TemplatePart</span><span class="o">&gt;</span> <span class="o">=</span>
</span><span class='line'>  <span class="n">many1</span> <span class="n">notOpenBracket</span>
</span><span class='line'>  <span class="o">|&gt;&gt;</span> <span class="o">(</span><span class="k">fun</span> <span class="n">charList</span> <span class="o">-&gt;</span>
</span><span class='line'>         <span class="n">charList</span>
</span><span class='line'>         <span class="o">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="kt">string</span>
</span><span class='line'>         <span class="o">|&gt;</span> <span class="nn">String</span><span class="p">.</span><span class="n">concat</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>         <span class="o">|&gt;</span> <span class="nc">Text</span><span class="o">)</span>
</span><span class='line'>  <span class="o">&lt;?&gt;</span> <span class="s2">&quot;&lt;text parser&gt;&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>There&rsquo;s a new function here and a couple of new operators (all taken from FParsec, by the way). <code>|&gt;&gt;</code> is a map operator; it allows you to transform the result of a parser and then rewrap everything back up into a new parser. This is really at the heart of the power of parser combinator libraries.</p>

<p>The <code>&lt;?&gt;</code> operator is much simpler: it allows you to name a parser rather than its name being some combination of the parsers it&rsquo;s built of.</p>

<p>The <code>many1</code> function says &ldquo;match one or more instances of the parser that follows&rdquo;. There is also a <code>many</code>, which matches 0 or more repeats.</p>

<p>So that&rsquo;s good &ndash; we can capture the text in between our replacable values. Let&rsquo;s go with a parser for the bracketed value names next!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">let</span> <span class="n">whitespace</span> <span class="o">:</span> <span class="nc">UParser</span><span class="o">&lt;</span><span class="kt">unit</span><span class="o">&gt;</span> <span class="o">=</span>
</span><span class='line'>  <span class="n">many</span> <span class="o">(</span><span class="n">satisfy</span> <span class="nn">System</span><span class="p">.</span><span class="nn">Char</span><span class="p">.</span><span class="nc">IsWhiteSpace</span> <span class="s2">&quot;&quot;</span><span class="o">)</span>
</span><span class='line'>  <span class="o">|&gt;&gt;</span> <span class="n">ignore</span>
</span><span class='line'>  <span class="o">&lt;?&gt;</span> <span class="s2">&quot;&lt;whitespace&gt;&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">valueName</span> <span class="o">:</span> <span class="nc">UParser</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span> <span class="o">=</span>
</span><span class='line'>  <span class="n">many1</span> <span class="o">(</span><span class="n">satisfy</span> <span class="o">(</span><span class="k">fun</span> <span class="n">c</span> <span class="o">-&gt;</span> <span class="n">c</span> <span class="o">&lt;&gt;</span> <span class="sc">&#39;}&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="ow">not</span> <span class="o">&lt;|</span> <span class="nn">System</span><span class="p">.</span><span class="nn">Char</span><span class="p">.</span><span class="nc">IsWhiteSpace</span> <span class="n">c</span><span class="o">))</span> <span class="s2">&quot;&quot;</span><span class="o">)</span>
</span><span class='line'>  <span class="o">|&gt;&gt;</span> <span class="o">(</span><span class="k">fun</span> <span class="n">charList</span> <span class="o">-&gt;</span> <span class="n">charList</span> <span class="o">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="kt">string</span> <span class="o">|&gt;</span> <span class="nn">String</span><span class="p">.</span><span class="n">concat</span> <span class="s2">&quot;&quot;</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">openValue</span> <span class="o">:</span> <span class="nc">UParser</span><span class="o">&lt;</span><span class="kt">unit</span><span class="o">&gt;</span> <span class="o">=</span>
</span><span class='line'>  <span class="n">pchar</span> <span class="sc">&#39;{&#39;</span> <span class="o">.&gt;&gt;.</span> <span class="n">whitespace</span>
</span><span class='line'>  <span class="o">|&gt;&gt;</span> <span class="n">ignore</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">closeValue</span> <span class="o">:</span> <span class="nc">UParser</span><span class="o">&lt;</span><span class="kt">unit</span><span class="o">&gt;</span> <span class="o">=</span>
</span><span class='line'>  <span class="n">whitespace</span> <span class="o">.&gt;&gt;.</span> <span class="n">pchar</span> <span class="sc">&#39;}&#39;</span>
</span><span class='line'>  <span class="o">|&gt;&gt;</span> <span class="n">ignore</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">value</span> <span class="o">:</span> <span class="nc">UParser</span><span class="o">&lt;</span><span class="nc">TemplatePart</span><span class="o">&gt;</span> <span class="o">=</span>
</span><span class='line'>  <span class="n">between</span> <span class="n">openValue</span> <span class="n">closeValue</span> <span class="n">valueName</span>
</span><span class='line'>  <span class="o">|&gt;&gt;</span> <span class="nc">Value</span>
</span><span class='line'>  <span class="o">&lt;?&gt;</span> <span class="s2">&quot;&lt;value parser&gt;&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>So we now have parsers for white space and our &ldquo;valueName&rdquo; (which we are saying must be at least one character long, and can consist of any character which is not whitespace or a closing curly bracket). We can then use pchar (&ldquo;parse char&rdquo;) and whitespace to allow for minor variations in syntax (some people like <code>{name}</code>, others like <code>{ name }</code>).</p>

<p>Finally we build our value parser, using the <code>between</code> function, which does pretty much what you&rsquo;d expect: it takes an opening parser, a closing parser, and captures what&rsquo;s in between with third parser.</p>

<p>Our final step is just to combine our parsers for value and text sections. We want to capture &ldquo;many&rdquo; of one or the other, until we run out of input. We&rsquo;ll put an explicit <code>pend</code> on there as well, otherwise things like (for example) an unclosed <code>}</code> at the end of the string will not show up as an error &ndash; the parser will just stop at the character before the opening <code>{</code> as the last matching input.</p>

<p>Our final parser introduces the <code>&lt;|&gt;</code> (orElse) operator, and looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">let</span> <span class="n">template</span> <span class="o">:</span> <span class="nc">UParser</span><span class="o">&lt;</span><span class="nc">TemplatePart</span> <span class="kt">list</span><span class="o">&gt;</span> <span class="o">=</span>
</span><span class='line'>  <span class="n">many</span> <span class="o">(</span><span class="n">value</span> <span class="o">&lt;|&gt;</span> <span class="n">textParser</span><span class="o">)</span>
</span><span class='line'>  <span class="o">.&gt;&gt;</span> <span class="n">pend</span>
</span><span class='line'>  <span class="o">&lt;?&gt;</span> <span class="s2">&quot;&lt;template parser&gt;&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s try it out!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">open</span> <span class="nn">System</span><span class="p">.</span><span class="nc">Text</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">showTemplate</span> <span class="n">values</span> <span class="n">parts</span> <span class="o">=</span>
</span><span class='line'>  <span class="k">let</span> <span class="n">folder</span> <span class="o">(</span><span class="n">sb</span> <span class="o">:</span> <span class="nc">StringBuilder</span><span class="o">)</span> <span class="n">part</span> <span class="o">=</span>
</span><span class='line'>    <span class="k">match</span> <span class="n">part</span> <span class="k">with</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Text</span> <span class="n">s</span> <span class="o">-&gt;</span>
</span><span class='line'>      <span class="n">sb</span><span class="o">.</span><span class="nc">Append</span> <span class="n">s</span>
</span><span class='line'>    <span class="o">|</span> <span class="nc">Value</span> <span class="n">v</span> <span class="o">-&gt;</span>
</span><span class='line'>      <span class="n">defaultArg</span> <span class="o">(</span><span class="nn">Map</span><span class="p">.</span><span class="n">tryFind</span> <span class="n">v</span> <span class="n">values</span><span class="o">)</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>      <span class="o">|&gt;</span> <span class="n">sb</span><span class="o">.</span><span class="nc">Append</span>
</span><span class='line'>  <span class="k">let</span> <span class="n">sb</span> <span class="o">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">fold</span> <span class="n">folder</span> <span class="o">(</span><span class="nc">StringBuilder</span><span class="bp">()</span><span class="o">)</span> <span class="n">parts</span>
</span><span class='line'>  <span class="n">sb</span><span class="o">.</span><span class="nc">ToString</span><span class="bp">()</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">values</span> <span class="o">=</span> <span class="nc">Map</span> <span class="o">[</span> <span class="s2">&quot;name&quot;</span><span class="o">,</span> <span class="s2">&quot;bob&quot;</span> <span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">run&#39;</span> <span class="n">parser</span> <span class="n">str</span> <span class="o">=</span>
</span><span class='line'>  <span class="n">run</span> <span class="n">parser</span> <span class="n">str</span>
</span><span class='line'>  <span class="o">|&gt;</span> <span class="k">function</span>
</span><span class='line'>     <span class="o">|</span> <span class="nc">Choice1Of2</span> <span class="n">success</span> <span class="o">-&gt;</span> <span class="n">showTemplate</span> <span class="n">values</span> <span class="n">success</span>
</span><span class='line'>     <span class="o">|</span> <span class="nc">Choice2Of2</span> <span class="n">fail</span> <span class="o">-&gt;</span> <span class="n">failwithf</span> <span class="s2">&quot;Parsing failed!</span><span class="se">\n</span><span class="s2">%s&quot;</span> <span class="n">fail</span>
</span></code></pre></td></tr></table></div></figure>


<p>A couple of helpers: <code>showTemplate</code> knows how to build up a string from a list of template parts and a value map, <code>run'</code> is just a simple wrapper around <code>run</code> that throws if parsing is not successful.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">let</span> <span class="n">ex1</span> <span class="o">=</span> <span class="s2">&quot;Welcome {name}! Please spend money here!&quot;</span>
</span><span class='line'><span class="k">let</span> <span class="n">ex2</span> <span class="o">=</span> <span class="s2">&quot;hello { name } thing&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">run&#39;</span> <span class="n">template</span> <span class="n">ex1</span>
</span><span class='line'><span class="c1">// val it : string = &quot;Welcome bob! Please spend money here!&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">run&#39;</span> <span class="n">template</span> <span class="n">ex2</span>
</span><span class='line'><span class="c1">// val it : string = &quot;hello bob thing&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">ex3</span> <span class="o">=</span> <span class="s2">&quot;Hello, { name }! How about {</span>
</span><span class='line'><span class="s2"> date:alreadyrendered?</span>
</span><span class='line'><span class="s2">}? &lt;- That should be left blank, but parse as valid.&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">run&#39;</span> <span class="n">template</span> <span class="n">ex3</span>
</span><span class='line'><span class="c1">// val it : string =</span>
</span><span class='line'><span class="c1">//   &quot;Hello, bob! How about ? &lt;- That should be left blank, but parse as valid.&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>And finally our templates in action. You can see that even with a simple parser like this, it&rsquo;s already reaching a complexity that would be painful to match with a hand rolled creation.</p>

<p>If you want to know more about parser combinators, and especially how to use them to create recursive grammars, do check out the <a href="http://www.quanttec.com/fparsec/">FParsec documentation</a> which is excellent. It is also more complete and <em>much</em> more performant than EmParsec.</p>

<p>But if you need a small, single file parser where performance is not the primary concern &ndash; maybe EmParsec is your friend. Anyone who wants to join in making it better is more than welcome! Of particular note is that EmParsec does not yet support controlling when backtracking does or doesn&rsquo;t happen (it will always backtrack) which can make for some pretty confusing error messages.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/angels-from-the-realms-of-glory/">Angels From the Realms of Glory</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-12-19T12:00:00+00:00" pubdate data-updated="true">Dec 19<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><blockquote><p>An angel of the Lord appeared to them, and the glory of the Lord shone around them, and they were terrified. <ref><a href="https://www.biblegateway.com/passage/?search=luke+2:9&version=NIV" title="Luke 2:9">Luke 2:9</a></ref></p></blockquote>

<p>It&rsquo;s that time of year again, where the F# community get together to source a collection of weird, wonderful and occasionally useful blog posts on life, the universe and sometimes Christmas.</p>

<p>As mentioned in last years post, I like to go back to the source when it comes to advent posts, so lets dive back into the book of Luke (and learn about agent based programming as we go).</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/angels-from-the-realms-of-glory/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/annoucing-at-mavnn-ltd/">Annoucing @mavnn Ltd</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-12-07T10:23:19+00:00" pubdate data-updated="true">Dec 7<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>As I hinted in the last post, new (and to me) exciting things are afoot. I&rsquo;m very pleased
to announce the formation of <a href="http://mavnn.co.uk">@mavnn ltd</a>!</p>

<h3>That&rsquo;s great, but what is it going to do?</h3>

<p>I&rsquo;m glad you asked! @mavnn ltd is the continuation of a lot of the things I&rsquo;ve come to care most about over my years in software development: building reliable, maintainable and well crafted code and teaching others to do the same.</p>

<p>You can check out the web page for more details, but basically there&rsquo;s three streams to what the company will be providing:</p>

<ul>
<li>Building code that works</li>
<li>Offering consultancy on how your team can build better software with less friction (especially around automating build, deployment and testing)</li>
<li>Giving training in skills that will allow teams to build solid software using functional programming techniques and thinking</li>
</ul>


<h3>What are doing already?</h3>

<p>I&rsquo;m glad you asked that too! Stream one of the company (&ldquo;Building code that works&rdquo;) is already well under way &ndash; we&rsquo;re very pleased to say that @mavnn ltd&rsquo;s first customer is <a href="https://github.com/logibit">Logibit</a>, where I&rsquo;m helping Henrik and Mikko build out the <a href="https://qvitoo.com/">Qvitoo</a> platform.</p>

<p>Although it&rsquo;s always nice as a small company to have contracts, we&rsquo;re particularly pleased to be working with Logibit: firstly because they&rsquo;re great people to work with &ndash; you don&rsquo;t need to work for them to find that out, just get involved in any of the myriad <a href="http://suave.io/">open</a> <a href="https://github.com/Albacore/albacore">source</a> <a href="https://github.com/logary/logary">projects</a> they&rsquo;re involved in!</p>

<p>Secondly, as a company they embody the things that @mavnn stands for: leveraging the ideas behind functional programming in deeply practical ways to build software that solves real world problems, and does so exactly as designed.</p>

<h3>Can I hire you?</h3>

<p>Yes! To avoid disappointment, though, I should make it clear that we have some ongoing contractual agreements and so will not be accepting ongoing full time contracts for the foreseeable future.</p>

<p>Training, consultancy, ongoing part time and short term full time contracts are all up for grabs though &ndash; including remotely and in some cases internationally as evidenced by our co-operation with Logibit. <a href="http://mavnn.co.uk/#contacts">Contact us to find out more</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/beginnings-and-endings/">Beginnings and Endings</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-11-26T12:02:10+00:00" pubdate data-updated="true">Nov 26<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There&rsquo;s the normal mix of excitement and sadness as I announce that today is my last day with my current employers, <a href="http://www.15below.com">15below</a>.</p>

<p>Sadness because the people here are great and I&rsquo;ve learned an unbelievable amount while working here. Excitement because there&rsquo;s
exciting things happening for the future. What are these brave new vistas? Well, that will have to wait for next week.</p>

<p>But for now, it&rsquo;s time for a brief thank you and review of what I&rsquo;m leaving.</p>

<p>Thanks 15below for:</p>

<ul>
<li>being an incredibly flexible, generous &amp; family friendly employer</li>
<li>Lots and lots of learning from existing code, conversations, other people delivering internal training, <a href="https://twitter.com/15below_travel/status/340475764677951488">letting me invite external speakers</a>, and the rest</li>
<li>releasing some open source, even while in an &ldquo;enterprise&rdquo; market: <a href="https://github.com/15below/">github</a></li>
<li>letting me <a href="http://blog.mavnn.co.uk/keeping-up-with-the-latest-hammer/">coordinate the internal developer education</a></li>
<li>sponsoring a <a href="http://blog.mavnn.co.uk/functional-programming-in-an-imperitive-world/">bunch</a> <a href="http://blog.mavnn.co.uk/sdd-conf-2015/">of</a>
<a href="http://blog.mavnn.co.uk/lambdacon-2015/">conference</a> speaking (there&rsquo;s more!)</li>
<li>trusting me to convert the build from msbuild to <a href="https://github.com/fsharp/FAKE">FAKE</a> and kick start the journey to automated deployment (which was a slow and painful one in msbuild world&hellip;)</li>
<li>picking solid, generous people <a href="https://www.facebook.com/15below/posts/829520247132711">as staff</a> &ndash; that&rsquo;s just one example from many, and the company often matches the giving of the staff</li>
</ul>


<p>I&rsquo;m hoping my last piece of work here, converting our main product repository to use <a href="http://fsprojects.github.io/Paket/">Paket</a> rather than nuget for dependency management is a gift that will keep on giving to the rest of the devs; here&rsquo;s to many more years of 15below bringing tech to the travel industry.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/easynetq-process-management/">EasyNetQ Process Management</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-10-05T12:23:02+01:00" pubdate data-updated="true">Oct 5<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><blockquote><p>TL;DR: I wrote a EasyNetQ aware process manager library. Read down for some examples, and leave feedback if you think anything should change before it&rsquo;s released.</p></blockquote>

<p><a href="http://easynetq.com/">EasyNetQ</a> is a nice little .net client library for RabbitMQ. Originally designed for introducing Rabbit (and the concepts of a bus based architecture)
to a company and programmers who hadn&rsquo;t previously used them before, it uses conventions to set up exchanges and queues &ndash; basing them on the names of the .net types that are
being sent and subscribe to.</p>

<p>For example (from the EasyNetQ homepage):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">bus</span><span class="p">.</span><span class="n">Publish</span><span class="p">&lt;</span><span class="n">MyMessage</span><span class="p">&gt;(</span><span class="n">message</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Will publish a message of type &ldquo;MyMessage&rdquo;. Generally there&rsquo;s no need to actually specify the type here, C# will infer it for you, but it makes the example clearer.</p>

<p>Other services can subscribe to &ldquo;MyMessage&rdquo; like so:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">bus</span><span class="p">.</span><span class="n">Subscribe</span><span class="p">&lt;</span><span class="n">MyMessage</span><span class="p">&gt;(</span><span class="s">&quot;my_subscription_id&quot;</span><span class="p">,</span> <span class="n">msg</span> <span class="p">=&gt;</span>
</span><span class='line'>      <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">Text</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>




</div>
  
  
    <footer>
      <a rel="full-article" href="/easynetq-process-management/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/extracting-information-from-msbuild/">Extracting Information From MsBuild</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-08-07T14:45:28+01:00" pubdate data-updated="true">Aug 7<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently as part of some research into making a large (very large) solution build more efficient, I started looking into whether there&rsquo;s anyway of getting MsBuild to do
some of the donkey work for you. This is especially important in situations where you want to know what&rsquo;s being used/produced with this particular set of parameters.</p>

<p>Obviously dealing with every possible custom build target is out of scope, but you can get a surprisingly long way by taking advantage of some of the intermediate build
targets used within the MsBuild Common targets files (imported into every *proj file created by Visual Studio).</p>

<p>Create yourself a little file called something like <code>Analyse.proj</code>, and put the following in it:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
</span><span class='line'><span class="nt">&lt;Project</span> <span class="na">ToolsVersion=</span><span class="s">&quot;12.0&quot;</span> <span class="na">DefaultTargets=</span><span class="s">&quot;WriteStuff&quot;</span> <span class="na">xmlns=</span><span class="s">&quot;http://schemas.microsoft.com/developer/msbuild/2003&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;Import</span> <span class="na">Project=</span><span class="s">&quot;$(TargetProject)&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;Target</span> <span class="na">Name=</span><span class="s">&quot;WriteStuff&quot;</span> <span class="na">DependsOnTargets=</span><span class="s">&quot;ResolveReferences&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;Message</span> <span class="na">Importance=</span><span class="s">&quot;high&quot;</span> <span class="na">Text=</span><span class="s">&quot;References::@(ReferencePath)&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;Message</span> <span class="na">Importance=</span><span class="s">&quot;high&quot;</span> <span class="na">Text=</span><span class="s">&quot;Compiles::@(BeforeCompile);@(Compile);@(AfterCompile)&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;Message</span> <span class="na">Importance=</span><span class="s">&quot;high&quot;</span> <span class="na">Text=</span><span class="s">&quot;Output::$(OutputPath)&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/Target&gt;</span>
</span><span class='line'><span class="nt">&lt;/Project&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is a mini-MsBuild project that imports an other project &ndash; the project you want to analyse. You can &ldquo;build&rdquo; this project like so:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'>PS C:\DirectoryWithProj&gt; <span class="err">&amp;</span> &#39;C:\Program Files (x86)\MSBuild\12.0\Bin\SBuild&#39; .\Analyse.proj /nologo /p:TargetProject=./Fake.Shake.fsproj
</span><span class='line'>Build started 07/08/2015 15:05:27.
</span><span class='line'>Project &quot;C:\DirectoryWithProj\Analyse.proj&quot; on node 1 (default targ ets).
</span><span class='line'>WriteStuff:
</span><span class='line'>  References::C:\rip\Fake.Shake\packages\FAKE.Lib\lib\net451\FakeLib.dll;C:\rip
</span><span class='line'>  \Fake.Shake\packages\FSharp.Core\lib\net40\FSharp.Core.dll;C:\rip\Fake.Shake\
</span><span class='line'>  packages\FsPickler\lib\net45\FsPickler.dll;C:\rip\Fake.Shake\packages\Hopac\l
</span><span class='line'>  ib\net45\Hopac.Core.dll;C:\rip\Fake.Shake\packages\Hopac\lib\net45\Hopac.dll;
</span><span class='line'>  C:\rip\Fake.Shake\packages\Hopac\lib\net45\Hopac.Platform.dll;C:\Program File
</span><span class='line'>  s (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5.1\mscorli
</span><span class='line'>  b.dll;C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFra
</span><span class='line'>  mework\v4.5.1\System.Core.dll;C:\Program Files (x86)\Reference Assemblies\Mic
</span><span class='line'>  rosoft\Framework\.NETFramework\v4.5.1\System.dll;C:\Program Files (x86)\Refer
</span><span class='line'>  ence Assemblies\Microsoft\Framework\.NETFramework\v4.5.1\System.Numerics.dll;
</span><span class='line'>  C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework
</span><span class='line'>  \v4.5.1\System.Runtime.Serialization.dll;C:\Program Files (x86)\Reference Ass
</span><span class='line'>  emblies\Microsoft\Framework\.NETFramework\v4.5.1\System.Xml.dll
</span><span class='line'>  Compiles::;Fake.Shake.Core.fs;Fake.Shake.Control.fs;Fake.Shake.DefaultRules.f
</span><span class='line'>  s;Fake.Shake.fs;
</span><span class='line'>  Output::bin\Debug\
</span><span class='line'>Done Building Project &quot;C:\DirectoryWithProj\Analyse.proj&quot; (default
</span><span class='line'>targets).
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Build succeeded.
</span><span class='line'>    0 Warning(s)
</span><span class='line'>    0 Error(s)
</span><span class='line'>
</span><span class='line'>Time Elapsed 00:00:00.12
</span></code></pre></td></tr></table></div></figure>


<p>And as you can see, whilst it&rsquo;s a bit ugly it generates a whole load of useful information for you about how <em>this</em> build with <em>these</em> properties will be built.</p>

<p>That&rsquo;s all for now!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/functional-programming-in-an-imperitive-world/">Functional Programming in an Imperative World</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-06-12T10:54:20+01:00" pubdate data-updated="true">Jun 12<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yesterday was the <a href="https://skillsmatter.com/conferences/7036-functional-programming-exchange-2015#skillscasts">Functional Programming Exchange 2015</a> and this being SkillsMatter,
the videos are already up. It&rsquo;s a great place to talk from that point of view, with consistently excellent organisation.</p>

<p>I was talking on being a &ldquo;Functional Programmer in an Imperative World&rdquo;; the slides are embedded below, but for the full experience check out the video at the link above.</p>

<iframe src="//www.slideshare.net/slideshow/embed_code/key/cSlUuPevYKsSHL" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe>


<p> <div style="margin-bottom:5px"> <strong> <a href="//www.slideshare.net/mavnn/functional-programming-in-an-imperitive-world" title="Functional Programming in an Imperitive World" target="_blank">Functional Programming in an Imperitive World</a> </strong> from <strong><a href="//www.slideshare.net/mavnn" target="_blank">mavnn</a></strong> </div></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/sdd-conf-2015/">Property Based Testing at SDD Conf 2015</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-06-08T10:21:44+01:00" pubdate data-updated="true">Jun 8<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So, nearly a month back now I had the fantastic opportunity to speak at this year&rsquo;s
<a href="http://sddconf.com/">Software, Design &amp; Development</a> at the Barbican on property based
testing &ndash; or more specifically, FsCheck.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/sdd-conf-2015/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/serialization-in-net/">Serialization in .net</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-05-21T16:11:28+01:00" pubdate data-updated="true">May 21<span>st</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Leaving the confines of your own process&rsquo;s safe little memory space is always a potentially painful moment
when you&rsquo;re coding up an up. Whether it&rsquo;s receiving data from the outside world, passing a message over
RabbitMQ to an other in house service, or writing an audit trail that needs to be accessible for the next
20 years, there&rsquo;s a bunch of considerations that need to be taken into account when you hit the joys of
serialization and deserialization.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/serialization-in-net/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/api-design-workshop/">API Design Workshop</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-05-07T15:35:51+01:00" pubdate data-updated="true">May 7<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Designing an API is hard.</p>

<p>You want to actually apply the
<a href="https://en.wikipedia.org/wiki/Principle_of_least_astonishment">principle of least astonishment</a> &ndash;
but you&rsquo;re the person who wrote the code. You&rsquo;re unlikely to be astonished. So
you&rsquo;re trying to think how someone who didn&rsquo;t know what you know would think &ndash;
which is never an easy starting point!</p>

<p>Similarly, you&rsquo;re trying to create the
<a href="http://blog.codinghorror.com/falling-into-the-pit-of-success/">pit of success</a>
for users. Which means trying to make it <em>very hard</em> to do the wrong thing with
your API. Preferably, in strongly typed languages, this should include using the
type system to
<a href="http://fsharpforfunandprofit.com/posts/designing-with-types-making-illegal-states-unrepresentable/">make illegal states unrepresentable</a>
so that code that compiles is very likely to work.</p>

<p>In general, the core libraries for .net are not bad at API design, but there are
a few places where this isn&rsquo;t true. As an exercise, we at
<a href="http://www.15below.com/">15below</a> are going to take one of them, split into
teams and spend an hour or so seeing what alternatives we can come up with. Feel
free to follow along at home, and if you do give it a try ping me a code snippet
and I&rsquo;ll post it up with our internal attempts in a week or so.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/api-design-workshop/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/emparsec-embedded-parser-library/">EmParsec Embedded Parser Library</a>
      </li>
    
      <li class="post">
        <a href="/angels-from-the-realms-of-glory/">Angels From the Realms of Glory</a>
      </li>
    
      <li class="post">
        <a href="/annoucing-at-mavnn-ltd/">Annoucing @mavnn Ltd</a>
      </li>
    
      <li class="post">
        <a href="/beginnings-and-endings/">Beginnings and Endings</a>
      </li>
    
      <li class="post">
        <a href="/easynetq-process-management/">EasyNetQ Process Management</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/mavnn">@mavnn</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mavnn',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/+MichaelNewtonmavnn?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - mavnn -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'mavnn';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
